<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/serif.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

          <section data-transition="slide-in fade-out">
            <h2>Protractor</h2>
            <h3>on the top of the testing piramid</h3>
          </section>

          <section data-transition="fade-in slide-out">
            <img class="plain" src="./img/angular-protractor.png" alt="Protractor Logo">
            <p class="fragment fade-up">Protractor is an end-to-end test framework for Angular and AngularJS applications.</p>
            <p class="fragment fade-in">Protractor runs tests against your application running in a real browser, interacting with it as a user would.</p>
          </section>
        </section>

        <section>
          <h4>How It Works</h4>
          <section>
            <img class="plain fragment fade-in" src="./img/components.png" alt="components">
            <br>
            <ul>
              <li class="fragment fade-in">Protractor is a Node.js program</li>
              <li class="fragment fade-in">Protractor is a wrapper around WebDriverJS</li>
              <li class="fragment fade-in">Selenium is a browser automation framework, includes Selenium Server, the WebDriver APIs, and the WebDriver browser drivers.</li>
            </ul>
          </section>
        </section>

        <section>
            <h3>Protractor needs two files to run:</h3>
            <p class="fragment fade-up">1. Configuration file</p>
            <p class="fragment fade-up">2. Test or spec file</p>
        </section>

        <section>
          <h4>Configuration file:</h4>
          <section>
<pre><code class="hljs" data-line-numbers="1-8">
  capabilities: {
    browserName: 'chrome',
    chromeOptions: {
        args: [ "--headless", "--window-size=800,600" ]
      }
  }

</code></pre>
          <div class="fragment fade-in">
            <p>Protractor supports the two latest major versions of Chrome, Firefox, Safari, and IE.</p>
            <img class="plain" src="./img//browsers.png" alt="Browsers">
          </div>
        </section>

        <section>
<pre><code class="hljs" data-line-numbers="1-5">
    directConnect: true,
    framework: 'jasmine'

  </code></pre>
        </section>

        <section>
<pre><code class="hljs" data-line-numbers="1-10">
  onPrepare() {
    require('ts-node').register({
      project: require('path').join(__dirname, './tsconfig.json')
    });
    jasmine.getEnv().addReporter(new SpecReporter({
      spec: { displayStacktrace: true }
    }));
  }

</code></pre></section>
        </section>

        <section>
          <h4>Spec/test file</h4>
          <section>
<pre><code class="hljs" data-line-numbers="1-13">
  describe('App Greeting page', async () => {
    it('should greet the named user', async () => {
      await browser.get('http://www.my-greeting-app.com');

      await element(by.name('userName')).sendKeys('John');

      const greeting = element(by.className('greeting'));

      expect(greeting.getText()).toEqual('Hello John!');
    });
  });

</code></pre>
            <ul style="list-style-type: none;">
              <li class="fragment fade-up">Protractor and Jasmin syntax only...</li>
              <li class="fragment fade-up">any interaction with application code</li>
            </ul>
          </section>
          <section>
<pre><code class="hljs" data-line-numbers="1-15">
  it('should add new post message', async () => {
    await element(by.css('.user-message-input'))
      .sendKeys('My test message');
    await element(by.id('submitButton'))
      .click();

    expect(await element.all(by.className('post'))
      .get(0)
      .getText())
      .toContain('My test message');
  });

</code></pre>
            <ul>
              <li class="fragment fade-up">element(by.css/ by.id/ by.className(''))</li>
              <li class="fragment fade-up">element().click()/ .getText()/ .all().get(0)</li>
            </ul>
          </section>
        </section>

        <section>
          <h2>Tests organization</h2>
          <h4>for building an Efficient Ecosystem</h4>
        </section>

        <section>
          <h4>Pattern Page Object</h4>
          <p class="fragment fade-up">...simply models pages as objects within the test code.</p>
          <br>
          <h6 class="fragment fade-up">Helps to avoid:</h6>
          <ul style="list-style-type: none">
            <li class="fragment fade-up">- Code duplication</li>
            <li class="fragment fade-up">- Maintenance problem</li>
            <li class="fragment fade-up">- Hard to understand</li>
          </ul>
        </section>

        <section>
          <h4>Page Object</h4>
          <p style="font-size: 70%"><i style="color: darkslategrey;">posts.po.ts</i> or <i style="color: darkslategrey;">posts.page-object.ts</i></p>
          <section data-transition="slide-in fade-out">
<pre><code class="hljs" data-line-numbers="1-15">
import { browser, by, element, ElementFinder } from 'protractor';

export class PostsPage extends BasePage {

  public async navigateToPostsPage(): Promise<void> {
    return super.navigateTo('/post-page');
  }

  public getMessageInputField(): ElementFinder {
    return element(by.css('.user-message-input'));
  }

 // more methods...
}

</code></pre>
          </section>
          <section data-transition="fade-in">
<pre><code class="hljs" data-line-numbers="1-15">
  public async enterMessage(): Promise<void> {
    return this.getMessageInputField().sendKeys('My test message');
  }

  public getPostMessageButton(): ElementFinder {
    return element(by.id('submitButton'));
  }

  public async clickPostMessageButton(): Promise<void> {
    return this.getPostMessageButton().click();
  }

  public async getLastPostedMessageText(): Promise<string> {
    return await element.all(by.className('post'))
      .get(0)
      .getText();
  }
}
</code></pre>

        </section>
      </section>

      <section>
        <h4>Usage Page Object in spec file</h4>
        <p style="font-size: 70%"><i style="color: darkslategrey;">posts.e2e-spec.ts</i></i></p>
          <section>
<pre><code class="hljs" data-line-numbers="1-15">
import { PostsPage } from './posts-page.po';

describe('Posts Page', async () => {
  let postsPO: AppPage;

  beforeAll(async () => {
    postsPO = new PostsPage();
    postsPO.navigateToPostsPage();
  });

</code></pre>
          </section>
          <section>
<pre><code class="hljs" data-line-numbers="1-15">
it('should add new post message', async () => {
  await postsPO.enterMessage();
  await postsPO.clickPostMessageButton();

  expect(await postsPO.getLastPostedMessageText()).toContain('My test message');
});

</code></pre>
          </section>
          <section>
<pre><code class="hljs" data-line-numbers="1-15">
it('should add new post message', async () => {
  await element(by.css('.user-message-input'))
    .sendKeys('My test message');
  await element(by.id('submitButton'))
    .click();

  expect(await element.all(by.className('post'))
    .get(0)
    .getText())
    .toContain('My test message');
});

</code></pre>
          </section>
        </section>

        <section>
          <h4>Project Structure</h4>
          <p style="font-size: 70%;">Group your e2e tests in a structure that makes sense to the structure of your project</p>
<pre><code class="hljs" data-line-numbers="1-15">
  |-- test
    |-- unit
    |-- e2e
      |-- page-objects
          home-page.js
          profile-page.js
          contacts-page.js
      home-spec.js
      profile-spec.js
      contacts-spec.js
</code></pre>
        <ul style="font-size: 50%;">
          <li class="fragment fade-up">Finding your e2e related files should be intuitive and easy</li>
          <li class="fragment fade-up">Makes the folder structure more readable</li>
          <li class="fragment fade-up">Clearly separates e2e tests from unit tests</li>
        </ul>
        </section>

        <section>
          <h4>Pitfals</h4>
          <img class="plain" src="./img/pitfals.jpg" alt="Meme_pitfals">
          https://www.protractortest.org/#/timeouts
          https://www.protractortest.org/#/infrastructure
        </section>

        <section>
          <h4>Best Practices</h4>
        </section>

        <section>
          <h4>Conclusions</h4>
        </section>

        <section>
          <h4>QA</h4>
        </section>

			</div>
		</div>

		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true }
				]
			});
		</script>
	</body>
</html>
